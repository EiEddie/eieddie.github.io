<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="抛体运动弹道解算# 模型# 本文考虑使用 线性阻力 模型. 事实上, 在空气中运动的阻力应该由 二次阻力 描述, 关于二者的对比将在 后文 给出.
之所以使用线性阻力, 是因为如此一来物体的运动微分方程
$$m \dot{\mathbf{v}} = -k \mathbf{v} - m g \hat{\mathbf{j}}$$有封闭解. 进一步令 \(\mu := \frac{k}{m}\), 上式化为
$$\dot{\mathbf{v}} = -\mu \mathbf{v} - g \hat{\mathbf{j}}$$容易解得
$$\mathbf{v} = \mathrm{e}^{-\mu t} \mathbf{v}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) g \hat{\mathbf{j}}$$积分得
$$ \mathbf{r} = \mathbf{r}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) \mathbf{v}_0 - \mu^{-2} (\mu t &#43; \mathrm{e}^{-\mu t} - 1) g \, \hat{\mathbf{j}} $$这就是线性阻力情况下的运动方程. 它也可以很轻松地分解为两个方向来运算.
与二次阻力的对比# 当速度较大 (\(\sim 20 ~ \mathrm{m/s}\)) 时, 弹丸在空气中运动的 雷诺数 很大, 并不适用于线性阻力. 但是在上升过程中, 速度逐渐下降, 雷诺数也逐渐变小, 于是在上升阶段用线性阻力模型的误差也不是很大.
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://example.org/docs/ballistics/">
  <meta property="og:site_name" content="EiEddie&#39;s Mind">
  <meta property="og:title" content="抛体运动弹道解算">
  <meta property="og:description" content="抛体运动弹道解算# 模型# 本文考虑使用 线性阻力 模型. 事实上, 在空气中运动的阻力应该由 二次阻力 描述, 关于二者的对比将在 后文 给出.
之所以使用线性阻力, 是因为如此一来物体的运动微分方程
$$m \dot{\mathbf{v}} = -k \mathbf{v} - m g \hat{\mathbf{j}}$$有封闭解. 进一步令 \(\mu := \frac{k}{m}\), 上式化为
$$\dot{\mathbf{v}} = -\mu \mathbf{v} - g \hat{\mathbf{j}}$$容易解得
$$\mathbf{v} = \mathrm{e}^{-\mu t} \mathbf{v}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) g \hat{\mathbf{j}}$$积分得
$$ \mathbf{r} = \mathbf{r}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) \mathbf{v}_0 - \mu^{-2} (\mu t &#43; \mathrm{e}^{-\mu t} - 1) g \, \hat{\mathbf{j}} $$这就是线性阻力情况下的运动方程. 它也可以很轻松地分解为两个方向来运算.
与二次阻力的对比# 当速度较大 (\(\sim 20 ~ \mathrm{m/s}\)) 时, 弹丸在空气中运动的 雷诺数 很大, 并不适用于线性阻力. 但是在上升过程中, 速度逐渐下降, 雷诺数也逐渐变小, 于是在上升阶段用线性阻力模型的误差也不是很大.">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2025-01-28T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-01-28T00:00:00+00:00">
    <meta property="article:tag" content="物理">
    <meta property="article:tag" content="数学">
    <meta property="article:tag" content="Julia">


  <meta itemprop="name" content="抛体运动弹道解算">
  <meta itemprop="description" content="抛体运动弹道解算# 模型# 本文考虑使用 线性阻力 模型. 事实上, 在空气中运动的阻力应该由 二次阻力 描述, 关于二者的对比将在 后文 给出.
之所以使用线性阻力, 是因为如此一来物体的运动微分方程
$$m \dot{\mathbf{v}} = -k \mathbf{v} - m g \hat{\mathbf{j}}$$有封闭解. 进一步令 \(\mu := \frac{k}{m}\), 上式化为
$$\dot{\mathbf{v}} = -\mu \mathbf{v} - g \hat{\mathbf{j}}$$容易解得
$$\mathbf{v} = \mathrm{e}^{-\mu t} \mathbf{v}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) g \hat{\mathbf{j}}$$积分得
$$ \mathbf{r} = \mathbf{r}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) \mathbf{v}_0 - \mu^{-2} (\mu t &#43; \mathrm{e}^{-\mu t} - 1) g \, \hat{\mathbf{j}} $$这就是线性阻力情况下的运动方程. 它也可以很轻松地分解为两个方向来运算.
与二次阻力的对比# 当速度较大 (\(\sim 20 ~ \mathrm{m/s}\)) 时, 弹丸在空气中运动的 雷诺数 很大, 并不适用于线性阻力. 但是在上升过程中, 速度逐渐下降, 雷诺数也逐渐变小, 于是在上升阶段用线性阻力模型的误差也不是很大.">
  <meta itemprop="datePublished" content="2025-01-28T00:00:00+00:00">
  <meta itemprop="dateModified" content="2025-01-28T00:00:00+00:00">
  <meta itemprop="wordCount" content="615">
  <meta itemprop="keywords" content="物理,数学,Julia">

<title>抛体运动弹道解算 | EiEddie&#39;s Mind</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://example.org/docs/ballistics/">
<link rel="stylesheet" href="/book.min.da13678e0f8d7d2b749f4c561f5f2f27b57defeb2b27e506235b21dcd411be4a.css" integrity="sha256-2hNnjg&#43;NfSt0n0xWH18vJ7V97&#43;srJ&#43;UGI1sh3NQRvko=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.9777f4c6ce2f46dd477a055b2f0f1c99767b90dd82fbd40a2f5edac4aac408ef.js" integrity="sha256-l3f0xs4vRt1HegVbLw8cmXZ7kN2C&#43;9QKL17axKrECO8=" crossorigin="anonymous"></script>



  


<script>
  window.MathJax = {
    tex: {
      inlineMath: [['\\(', '\\)']],
      displayMath: [['$$', '$$']]
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };
</script>
<script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"
  async>
</script>



</head>
<body dir="ltr" class="book-kind-page book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>EiEddie&#39;s Mind</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>













  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/article-processing-pipeline/" class="">
      文章处理管线</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/hugo-with-math/" class="">
      为 Hugo 添加数学支持</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/static-site-with-hugo/" class="">
      使用 Hugo 搭建静态站点</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/calc-with-unit/" class="">
      带有单位的物理计算</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/qm-angular-momentum/" class="">
      量子力学中的角动量</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/jordan-normal-form/" class="">
      若尔当标准型</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/commutative-lt/" class="">
      可交换的线性变换</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dynamic-simulation-of-density-fluids/" class="">
      密度流体的动态模拟</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/long-time-ago-a-essay/" class="">
      从中科大回来的时候我母亲就预言了我的今天</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/esp32-dev/" class="">
      ESP32 环境配置与开发</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/mahony-complementary-filter/" class="">
      Mahony 非线性互补滤波器</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/async-serial/" class="">
      异步非阻塞串口数据接收</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rigid-movement/" class="">
      三维空间中刚体运动的描述</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rigid-rotation/" class="">
      三维空间中旋转的描述</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/time-series-forecasting-using-taylor/" class="">
      使用泰勒展开的运动预测</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/ballistics/" class="active">
      抛体运动弹道解算</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/conventional-commits/" class="">
      约定式提交</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/git-submodule/" class="">
      `git` 子模块</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/repo-struct/" class="">
      关于知识库框架结构的一些想法</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/git-tips/" class="">
      Git Tips</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/vscode-cmake-with-msvc/" class="">
      Windows 下的现代 C/C&#43;&#43; 开发环境配置</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux-to-go/" class="">
      在移动介质中安装操作系统</a>
  

        </li>
      
    
  </ul>













</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>抛体运动弹道解算</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#模型">模型</a>
      <ul>
        <li><a href="#与二次阻力的对比">与二次阻力的对比</a></li>
      </ul>
    </li>
    <li><a href="#轨迹方程">轨迹方程</a>
      <ul>
        <li><a href="#确定初值">确定初值</a></li>
      </ul>
    </li>
    <li><a href="#排除不可达点">排除不可达点</a>
      <ul>
        <li><a href="#射角范围">射角范围</a></li>
        <li><a href="#包络线">包络线</a></li>
        <li><a href="#其他">其他</a></li>
      </ul>
    </li>
    <li><a href="#代码实现">代码实现</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="抛体运动弹道解算">抛体运动弹道解算<a class="anchor" href="#%e6%8a%9b%e4%bd%93%e8%bf%90%e5%8a%a8%e5%bc%b9%e9%81%93%e8%a7%a3%e7%ae%97">#</a></h1>
<h2 id="模型">模型<a class="anchor" href="#%e6%a8%a1%e5%9e%8b">#</a></h2>
<p>本文考虑使用 <a href="https://zh.wikipedia.org/wiki/%e9%98%bb%e5%8a%9b#%e9%9b%b7%e8%ab%be%e6%95%b8%e5%be%88%e4%bd%8e%e6%99%82%e7%9a%84%e9%98%bb%e5%8a%9b"><em>线性阻力</em></a> 模型.
事实上, 在空气中运动的阻力应该由 <a href="https://zh.wikipedia.org/wiki/%e9%98%bb%e5%8a%9b#%e9%ab%98%e9%80%9f%e6%99%82%e7%9a%84%e9%98%bb%e5%8a%9b"><em>二次阻力</em></a> 描述, 关于二者的对比将在 <a href="#%e4%b8%8e%e4%ba%8c%e6%ac%a1%e9%98%bb%e5%8a%9b%e7%9a%84%e5%af%b9%e6%af%94">后文</a> 给出.</p>
<p>之所以使用线性阻力, 是因为如此一来物体的运动微分方程</p>
$$m \dot{\mathbf{v}} = -k \mathbf{v} - m g \hat{\mathbf{j}}$$<p>有封闭解. 进一步令 \(\mu := \frac{k}{m}\), 上式化为</p>
$$\dot{\mathbf{v}} = -\mu \mathbf{v} - g \hat{\mathbf{j}}$$<p>容易解得</p>
$$\mathbf{v} = \mathrm{e}^{-\mu t} \mathbf{v}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) g \hat{\mathbf{j}}$$<p>积分得</p>
$$
\mathbf{r} = \mathbf{r}_0 - \mu^{-1} (1-\mathrm{e}^{-\mu t}) \mathbf{v}_0 - \mu^{-2} (\mu t + \mathrm{e}^{-\mu t} - 1) g \, \hat{\mathbf{j}}
$$<p>这就是线性阻力情况下的运动方程. 它也可以很轻松地分解为两个方向来运算.</p>
<h3 id="与二次阻力的对比">与二次阻力的对比<a class="anchor" href="#%e4%b8%8e%e4%ba%8c%e6%ac%a1%e9%98%bb%e5%8a%9b%e7%9a%84%e5%af%b9%e6%af%94">#</a></h3>
<p>当速度较大 (\(\sim 20 ~ \mathrm{m/s}\)) 时, 弹丸在空气中运动的 <a href="https://zh.wikipedia.org/wiki/%e9%9b%b7%e8%af%ba%e6%95%b0#%e6%b5%81%e4%bd%93%e4%b8%ad%e7%9a%84%e7%90%83"><em>雷诺数</em></a> 很大, 并不适用于线性阻力.
但是在上升过程中, 速度逐渐下降, 雷诺数也逐渐变小, 于是在上升阶段用线性阻力模型的误差也不是很大.</p>
<p>下面的图展示了无阻力, 线性阻力与二次阻力在初速 \(20 ~ \mathrm{m/s}\), 射角 \(60^\circ\) 时的运动轨迹, 可以看到上升阶段两条阻力曲线都十分接近, 随着下降时速度越来越快才逐渐分离.</p>
<p><img src="/figs/Ballistics/mv_tracks.png" alt="运动轨迹" /></p>
<p>显然两种阻力的系数量纲不同, 于是其值也必然不同.
找到合适的线性阻力系数就成为逼近真实情况的重点之一.
在流体中的二次阻力可以用 \(f = \frac{1}{2} \rho v^2 C_d S\) 计算,
其中 \(\rho\) 为流体密度; \(C_d\) 为阻力系数, 由实验得出; \(S\) 为参考面积.
我们希望由此推出线性阻力的系数, 使二者轨迹相差无几.</p>
<p>我们令 \(\kappa = \frac{1}{2} \frac{\rho C_d S}{m}\),
于是二次阻力情况下加速度 \(\mathbf{a}_f = -\kappa |\mathbf{v}| \mathbf{v}\);
对比线性阻力情况下 \(\mathbf{a}_f = -\mu \mathbf{v}\), 可以看出重点是找到一个合适的 \(\mu\), 使得其在 \(\mathbf{v}\) 不断变化的时候仍有 \(\mu \sim \kappa |\mathbf{v}|\).</p>
<p>一种朴素的想法是使 \(\mu\) 等于 \(\kappa |\mathbf{v}|\) 的均值.
也就是令</p>
$$\mu = \kappa \frac{\int_{0}^{t} |\mathbf{v}| ~ \mathrm{d} t}{t}$$<p>注意到二次阻力模型下运动方程</p>
$$\begin{align*}
\dot{v}_x &= -\kappa |\mathbf{v}| ~ v_x \\
\dot{v}_y &= -\kappa |\mathbf{v}| ~ v_y - g
\end{align*}$$<p>蕴含一个 \(|\mathbf{v}|\). 只考虑 \(x\) 方向, 可得</p>
$$\begin{align*}
\int_{0}^{t} \kappa |\mathbf{v}| ~ \mathrm{d} t &= -\int_{0}^{t} \frac{\dot{v}_x}{v_x} ~ \mathrm{d} t \\
&= -\int_{v_{0x}}^{v_x} \frac{\mathrm{d} v_x}{v_x} \\
&= \ln{\frac{v_{0x}}{v_x}}
\end{align*}$$<p>于是 \(\mu = t^{-1} \ln{(v_{0x}/v_x)}\).</p>
<p>可以通过欧拉法取得 \(v_x\) 的数值解,
对于给定的 \(t\), 可以认为在这段时间内 ( \(0 \sim t\) ) 使用 \(\mu\) 的线性阻力模型与使用 \(\kappa\) 的二次阻力模型取得的轨迹相差无几.</p>
<p>但是应该注意, 随着 \(t\) 的增大, \(v_x\) 逐渐减小趋近于 \(0\), 因此 \(t\) 不宜取得太大.
实际应用中, 可以用射角 \(45^\circ\), 在上升到最高点之前的时间段计算的 \(\mu\) 来作为通用结果使用.</p>
<p><img src="/figs/Ballistics/compare_y_when_x.png" alt="x相同时y的差值" /></p>
<p>上图展示了参数为 \(\kappa\) 的二次阻力模型与计算得到的使用 \(\mu\) 的线性阻力模型, 以及无阻力模型在 \(y\) 方向上的差值. 射角 \(60^\circ\), 初速 \(20 ~ \mathrm{m/s}\).
可以看出线性阻力模型在 \(x > 15 ~ \mathrm{m}\) 时才有显著的偏差.</p>
<h2 id="轨迹方程">轨迹方程<a class="anchor" href="#%e8%bd%a8%e8%bf%b9%e6%96%b9%e7%a8%8b">#</a></h2>
<p>将运动方程中 \(t\) 消去, 即为轨迹方程.</p>
<p>我们先将初速度 \(\mathbf{v}_0\) 分解为 \(v_0 ~ (\cos{\theta}, \sin{\theta})\), 而后在 \(x\) 方向解出 \(t\):</p>
$$t = \mu^{-1} \ln{\frac{v_0 \cos{\theta}}{v_0 \cos{\theta} - \mu x}}$$<p>之后将其代入 \(y\) 方向, 化简得</p>
$$
y - \frac{g}{\mu^2 v_0} (\mu x \sec{\theta} - v_0 \ln{\frac{v_0}{v_0 - \mu x \sec{\theta}}}) - x \tan{\theta} = 0
$$<p>轨迹上的点 \((x, y)\) 都应满足于上面的方程, 这便是轨迹方程.</p>
<p>在初速 \(v_0\) 确定的情况下, 这是关于 \(\theta\) 的一个方程. 想要得到给定轨道上一点 \((x, y)\) 的情况下 \(\theta\) 的值, 只需解这个方程就好.
可以用诸如 <em>牛顿法</em> 等数值方法来获得相当精确的解.</p>
<h3 id="确定初值">确定初值<a class="anchor" href="#%e7%a1%ae%e5%ae%9a%e5%88%9d%e5%80%bc">#</a></h3>
<p>牛顿法等迭代方法是初值敏感的, 初值的选取决定了迭代的次数与最终精度. 对于有多个根的函数, 初值还决定了最终结果是哪一个根.</p>
<p>显而易见, 对于一般的目标, 抛体运动总有两条可达的轨迹. 一条是在上升时到达, 一条则在下降时.
我们总是更喜欢上升时到达的情况, 因为这样运动的时间短, 且可以使用线性阻力模型更精确地模拟, 误差更小. 这就对初值的选取提出了要求.</p>
<p>令轨迹方程左边为目标函数 \(f(\theta)\), 规定定义域为 \((-\frac{\pi}{2}, \frac{\pi}{2})\) 的子集,
作图观察 (曲线; \(\mu = 0.01\), \(v = 20 ~ \mathrm{m/s}\), \((x, y) = (5, 0.5)\)):</p>
<p><img src="/figs/Ballistics/target_func.png" alt="目标函数" /></p>
<p>显然有两个解. 并且容易想到上升时到达的轨迹, 射角小于下降时到达的, 于是左边一根即为所求射角.</p>
<p>对目标函数求导并令其等于 \(0\), 可以得到其极值. 容易证明, 其极值至多一个, 且为最小值. 这里直接给出目标函数的最小值点:</p>
$$\theta = \arctan{\frac{v_0^2}{g x}} - \arctan{\frac{\mu x}{\sqrt{v_0^2 + x^2 ((g / v_0)^2 - \mu^2)}}}$$<p>假如我们将初值选在最小值点的左侧, 那么迭代求出的根就是较小的一根.
进一步我们想到, 相较于 <strong>区间最左端的点</strong> 或 <strong>最小值点左邻域内的点</strong>, 不妨取这两点连线, 即图上斜线与 \(x\) 轴的交点, 这样更接近于根.
如此一来还可以避开上述两点附近数值不稳定的区域.</p>
<h2 id="排除不可达点">排除不可达点<a class="anchor" href="#%e6%8e%92%e9%99%a4%e4%b8%8d%e5%8f%af%e8%be%be%e7%82%b9">#</a></h2>
<p>给定的目标点并不总是有可达的抛体轨迹. 若是能在计算前将其排除, 便可避免再在繁杂的计算中消耗时间.
需要注意的是, 排除过程也需耗时, 且对于每个输入数据都需要计算, 因此需要平衡前期排除与正式计算间的平衡, 以优化耗时.</p>
<h3 id="射角范围">射角范围<a class="anchor" href="#%e5%b0%84%e8%a7%92%e8%8c%83%e5%9b%b4">#</a></h3>
<p>实际应用中, 射角几乎总是不能达到 \((-\frac{\pi}{2}, \frac{\pi}{2})\), 于是若目标点与原点的夹角大于射角的最大值, 那么显然不能到达.</p>
<p>尤其注意, 当夹角小于射角最小值时, 仍然有可能到达, 因为物体在重力作用下会下坠.</p>
<h3 id="包络线">包络线<a class="anchor" href="#%e5%8c%85%e7%bb%9c%e7%ba%bf">#</a></h3>
<p>另外, 若是无阻力模型都到达不了的点, 那么线性乃至于二次阻力模型也一定不可达.
因此可以使用抛物线的包络线来检查, 若是在包络线以外 (以上) 的点, 一定是不可达点.</p>
<p>对于无阻力的抛体运动, 可以直接写出其运动方程</p>
$$\begin{align*}
x &= v_0 t \cos{\theta} \\
y &= v_0 t \sin{\theta} - \frac{1}{2} g t^2
\end{align*}$$<p>两式联立消去 \(t\), 得到</p>
$$\begin{align*}
y &= v_0 \sin{\theta} ~ \frac{x}{v_0 \cos{\theta}} - \frac{1}{2} g (\frac{x}{v_0 \cos{\theta}})^2 \\
  &= x \tan{\theta} - \frac{g x^2}{2 v_0^2} \sec^2{\theta} \\
  &= x \tan{\theta} - \frac{g x^2}{2 v_0^2} (1 + \tan^2{\theta})
\end{align*}$$<p>以 \(\theta\) 为未知数, 若是其恰有一解, 则上述轨迹方程处于临界状态; 若目标点再稍抬高则不可达.
注意到上述方程为关于 \(\tan{\theta}\) 的二次方程, 且 \(\tan{x}\) 在 \((-\frac{\pi}{2}, \frac{\pi}{2})\) 内为双射, 于是令</p>
$$\begin{align*}
\Delta &= x^2 - 4 \frac{g x^2}{2 v_0^2} (\frac{g x^2}{2 v_0^2} + y) \\
       &= 0
\end{align*}$$<p>即</p>
$$y = -\frac{g}{2 v_0^2} x^2 + \frac{v_0^2}{2 g}$$<p>这便是抛体运动的包络线方程. 若点 \((x, y)\) 在方程之上, 则不可到达.</p>
<h3 id="其他">其他<a class="anchor" href="#%e5%85%b6%e4%bb%96">#</a></h3>
<p>在实际计算中对于根号与分式要特别注意, 防止出现超出定义域的情况. 可以在计算前简要判断一下, 确保各函数的自变量都在其定义域内.</p>
<h2 id="代码实现">代码实现<a class="anchor" href="#%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0">#</a></h2>
<p>代码 [<a href="https://github.com/EiEddie-s-Mind/julia/blob/master/ballistic.jl">Web</a>] 由 <code>julia</code> 编写. Benchmark 显示其性能十分卓越:</p>
<pre><code>#@benchmark θ([5.,0.5], 20., 9.8, 0.1, (-pi/6,pi/3))
BenchmarkTools.Trial: 10000 samples with 223 evaluations per sample.
 Range (min … max):  331.390 ns …  19.150 μs  ┊ GC (min … max): 0.00% … 97.41%
 Time  (median):     335.426 ns               ┊ GC (median):    0.00%
 Time  (mean ± σ):   363.941 ns ± 333.661 ns  ┊ GC (mean ± σ):  1.97% ±  2.52%

 Memory estimate: 80 bytes, allocs estimate: 2.
</code></pre>
<p>可以看到计算一次的时间仅为 \(335.426 ~ \mathrm{ns}\) (中位数), 占用 \(80\) 字节空间.</p>
</article>
 
      




  <div class="flex flex-wrap justify-between">
    <div class="flex align-center text-sm text-muted">
      
      <span class="overline" style="font-style:italic;">Last updated: January 28, 2025</span>
    </div>
  </div>




      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/time-series-forecasting-using-taylor/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>使用泰勒展开的运动预测</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/conventional-commits/" class="flex align-center">
        <span>约定式提交</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
  <div class="book-comments">

</div>
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#模型">模型</a>
      <ul>
        <li><a href="#与二次阻力的对比">与二次阻力的对比</a></li>
      </ul>
    </li>
    <li><a href="#轨迹方程">轨迹方程</a>
      <ul>
        <li><a href="#确定初值">确定初值</a></li>
      </ul>
    </li>
    <li><a href="#排除不可达点">排除不可达点</a>
      <ul>
        <li><a href="#射角范围">射角范围</a></li>
        <li><a href="#包络线">包络线</a></li>
        <li><a href="#其他">其他</a></li>
      </ul>
    </li>
    <li><a href="#代码实现">代码实现</a></li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>




















